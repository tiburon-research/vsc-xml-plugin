# 2.2.0 (23.08.2019)

### Улучшения

* Добавлены команды:
  - `Обернуть текущий тег в CDATA` (`ctrl`+ `alt` + `shift` + `c`): оборачивает не выделенный фрагмент, а содержимое того тега, в котором сейчас находится курсор.
  - `SexAgeList`: это как `AgeList`, только с пересечением на пол.
  - `Вставить шаблон ротации` (`ctrl` + `alt` + `r`): добавляет шаблон из `RespInfo` + `Generable` + `Repeat` в зависимости от того, как должна выглядеть база (ротированная/разротированная).
* При генерации XML-элементов из текста теперь учитывается нумерация через `)` и буквенные списки.
* При генерации Answer из текста теперь могут получится открытые и исключающие ответы.
* Добавлен C#-шаблон для метода перекодировки возраста в интервалы (`#ageIntervals`).
* Добавлена возможность запускать свои JS-методы. Подробнее — см. раздел `Пользовательские методы` в readme.

### Исправления

* При оборачивании в CDATA не добавляются лишние переносы.

# 2.2.0 (16.08.2019)

### Улучшения

* Добавлена команда выбора географии (`ctrl` + `alt` + `G`, команда выделения родительского тега перенесена на сочетание `ctrl` + `alt` + `shift` + `P`). Детали см. в readme.

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/geo.gif?raw=true)

* В XMLPath добавлены Id и индексы:

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/XMLPath.jpg?raw=true)

### Исправления

* Исправлена ошибка разбора пустых тегов.
* Оптимизация и рефакторинг кода расширения.


# 2.1.0 (08.07.2019)

### Улучшения
* Добавлены новые и удалены устаревшие XML-атрибуты.
* Добавлена новая команда `Преобразовать в Page` на сочетание клавиш `ctrl`+`alt`+`A`, а старая (`Преобразовать в Answers`) перенесена в `ctrl`+`alt`+`shift`+`A`. Новая команда всегда создаёт полную структуру Page+Question+Answer. При этом считается, что первая строка — это заголовок вопроса, в которой ищется Id. Id с русскими символами теперь распознаются и подвергаются транслитерации. Старая команда создаёт только список Answer.
* При ошибках в преобразованиях теперь показывается более подробная информация.

### Исправления
* Исправлено залипание расширения после мультистрочной вставки.
* Проверка Id теперь регистрочувствительная.
* После автозавершения метода теперь снова подставляются скобки.
* Исправлены проблемы при генерации XML, когда через табуляцию были цифры/буквы в разном порядке. Теперь Id выделяются только если все элементы соответсвуют одинаковому шаблону.


# 2.0.0 (14.05.2019)

Расширение переписано, чтобы не зависало при сохранении больших файлов.

### Улучшения
* Не зависает при сохранении больших файлов!

### Исправления
* Изменено название команды `tib.commentBlock` на `tib.surveyBlock`.
* Из настроек удалены параметры `tib.ignoreComments` и `tib.LogPath`.
* Теперь при закрытии документа все проблемы (ошибки при диагностике), связанные с ним, удаляются из списка.
* Исправлено неправильное определение положения в XML при наличии пустого тега.

### Другое
* Удалена настройка `tib.enableCache`.
* Пока не починят миксы добавлена ошибка на случай наличия Mix в Repeat и родителе


# 0.3 (26.10.2018)

### Исправления
* Все комманды, шаблоны и автозавершения теперь должны корректно работать с мультикурсорным вводом.
* Исправлены и улучшены шаблоны.
* Исправлена замена заглавной буквы в начале тега.
* Исправлена подсветка блоков.

### Улучшения
* Положено начало диагностике (красные и зелёные подчёркивания) и исправлениям (жёлтые лампочки рядом с подчёркиванием).

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/diagnostic.gif?raw=true)
* В автоподстановку добавлены вопросы `pre_sex` и `pre_age`.
* Преобразование текста в XML теперь работает как snippet.
* Добавлена подсветка и автозавершение `$all`, `$sex`, `$age`, `$today`.
* Готовые шаблоны (которые с префиксом `_` и `#`) теперь подставляются в соответствии с языком, но теперь их нельзя завязать на комбинацию клавиш.
* Комманда комментирования строки адаптирована под разные языки.
* Добавлено автоматическое исправление двойной заглавной буквы в начале тега.
* добавлена настройка для отключения блокировки редактируемых файлов `tib.enableFileLock`.


* И много всякой исправленной мелочи.


# 0.2.5 (0.2.6, 0.2.7 fast fix) (24.08.2018)

### Исправления
* Исправлено определения языка при нахождении внутри CustomText.
* Переход к определению теперь должен работать из любого места скрипта.

### Улучшения
* Улучшена автоподстановка:
  - теперь предлагаются известные Id вопросов;
  - каждого типа элементов свой значок;
  
  ![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/icons.jpg?raw=true)
  - теперь подставляются `MixId`, в том числе генерабельные;
* Переход к определению для Question теперь тоже работает.
* Добавлена автозамена первой буквы тега на заглавную (настройка `tib.upcaseFirstLetter`).
* Изменены имена сущностей для тем. Константы и встроенные строчные функции теперь одного цвета.
* Добавлены новые шаблоны:
  - $place;
  - краткая структура Answer/Item внутри Repeat;
* В автозавершение добавлены функции `ExtSurvey*`, которые пока не работают, но скоро будут (Костя объявит, когда уже можно) =)
* Добавлены команды преобразования текста в XML (сочетания клавиш: `Ctrl`+`Alt`+`A` для Answer и `Ctrl`+`Alt`+`I` для Item) (подробнее см. Readme по командам).

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/convert.gif?raw=true)
* Ну и, конечно, много всякой оптимизации.



# 0.2.4 (15.08.2018)

### Исправления
* Окошко вывода (чёрное, внизу) теперь не выскакивает каждый раз при смене вкладки/открытии файла.
* При изменении только имени атрибута значение нового не подставляется.
* В подсказках при наведении и вводе параметров теперь проверяются родители свойств/методов (раньше была путаница с одноимёнными).

* Другие мелкие баги.

### Улучшения
* Исправлены старые и добавлены новые шаблоны.
* Окошки, всплывающие при открытии заблокированных файлов, стали более информативными. Чтобы в них всегда показывался полный путь к файлу нужно изменить настройку `tib.showFullPath`.
* [теги] теперь закрываются автоматически даже при мультикурсорном вводе.
* Константы выделены в отдельный элемент языка (+ подсветка в теме Tiburon Dark).
* Для ресурсоёмких процессов отображается статус их выполнения (нижняя левая панель).
* Улучшена схема определения заблокированных файлов.
* При автозавершении в C# теперь сначала идут пользовательские методы.
* Добавлена подсветка границ сворачивающегося (`<!--#block-->`) блока (при нахождении курсора на одной из них).
* По `<Include>` теперь можно перейти к указанному файлу.


# 0.2.3 (26.06.2018)

### Исправления
* Исправлена генерация `ageList`.
* Исправлена и улучшена сортировка списка. Теперь можно выделять сразу несколько листов и они будут сортироваться отдельно.
* Стандартное сочетание клавиш `Ctrl`+`Alt`+`V` для мультистрочной вставки заменено на `Ctrl`+`Shift`+`V`, т.к. старое почему-то перестало работать.


### Улучшения
* При открытии `tib` файла он блокируется для всех остальных пользователей. Подробнее см README, раздел `Редактирование файлов`.
* Выделены поддерживающиеся спецсимволы HTML (серым в теме Tiburon Dark).
* Добавлены новые и улучшены старые шаблоны кода.
* В README (раздел `Сочетание клавиш`) добавлен список шаблонов кода, которые можно повесить на горячие клавиши.
* При нахождении внутри тега `Var` в строке состояния теперь указан его индекс.
* Кардинально улучшен отчёт об ошибках.
* Для Question добавлен атрибут `Reverse`. Он работает, вы знали?

* Много других исправлении и улучшений (оптимизация, подсветка, форматирование синтаксиса и т.д.).


# 0.2.2 (01.06.2018)

### Исправления
* Исправлена `"Ошибка при получении определения метода"`, возникавшая у большинства в версии `0.2.1`.
* Исправлена ошибка, возникавшая во многих преобразованиях (особенно заметна была в `-> AgeList`).
* Подсветка синтаксиса внутри `[c#]` иногда ломалась.

### Улучшения
* Отчёт об ошибках теперь должен помочь гораздо быстрее находить проблемные места.
* Процесс загрузки расширения и возникновение ошибок теперь можно отследить в выводе на вкладке `tib`.
* Добавлены некоторые подсказки по оптимизации расширения (в виде всплывающих окон). Отключить можно в настройках: `tib.showHelpMessages`.
* Добавлены и исправлены некоторые шаблоны.


# 0.2.1 (24.05.2018)

### Исправления
* Форматирование ломалось при наличии `$repeat` и `@"`.
* C#-теги (`Filter`, `Redirect` и т.д.) раньше не закрывались автоматически.
* CDATA иногда ломала подсветку парных тегов.
* Заботала автоподстановка атрибутов `Item` внутри `Condition` и `Repeat`.
* Заботала команда `Выделить родительский тег`.
* Исправлена и улучшена команда комментирования.
* Отловлено много возможных исключений.
* Другие мелкие исправления.

### Улучшения
* Расширение теперь работает со всеми подключёнными (через `<Include>`) в скрипте файлами.
* Квадратные скобки теперь автоматически закрываются в C#, CSS и JS.
* В C#-строках теперь закрываются <теги>.
* Добавлена команда `Сортировка списка`, подробнее см. readme.
* Оптимизирована загрузка расширения и обновление данных при смене файла (т.е. стало чуть быстрее).
* В Readme добавлены разделители для удобства чтения.


# 0.2.0 (15.05.2018)

Внешне расширение поменялось не сильно, но внутри оно почти совсем новое.  
В связи с этим оно стало работать гораздо правильнее и местами даже быстрее, но могут появиться и проблемы =)

### Исправления
* Раньше преобразования `Answer <-> Item` могли работать некорректно во многих случаях.
* Исправлено много ошибок и неточностей при форматировании.
* Теперь при вводе строчных методов ничего не должно зависать.
* Убраны подсказки при объявлении методов.
* Нахождение парного тега не всегда работало правильно при нескольких вложенных `Repeat`.
* Скрыто сообщение об ошибке при отправке ошибки, которое возникало из-за блокировки сервисов Telegram.

### Улучшения
* Добавлена возможность кэширования документа. Это должно помочь быстродействию в больших документах (особенно с большим количеством комментариев или CDATA). По умолчанию функция отключена (т.к. пока работает в тестовом режиме), можно включить в настройках: `tib.enableCache`.
* Добавлены C#-шаблоны.
* Заменены автоподставляемые значения для boolean атрибутов - теперь они !default.
* Вывод в панель информации о текущем теге (по положению курсора). Отключается в настройках `tib.ShowTagInfo`.
* Новые команды:
  - `Удалить Id вопросов из заголовков` - удаление Id, находящихся в начале заголовков вопросов;
  - `-> AgeList` - преобразование текста в AgeList;
  - `Открыть шаблон tibXML` (`Ctrl`+`Alt`+`Shift`+`N`) - открывает новый файл по выбранному шаблону. Указать папку с шаблонами можно в настройках `tib.templatePath`.

### Очень много других мелких исправлений


# 0.1.3 (29.03.2018)

### Исправления
* все команды теперь работают только для документа `Tiburon XML script`;
* для пользовательских методов раньше не было подсказок при вводе;
* команда `Выделить родительский тег` не работала для элементов с единственным родителем.

### Улучшения
* благодаря разработчикам [этого расширения](https://marketplace.visualstudio.com/items?itemName=Leopotam.csharpfixformat) C# теперь тоже форматируется (подробнее см раздел `Форматирование` в README).


# 0.1.2 (22.03.2018)

### Исправления

* форматирование переделано почти полностью, в частности:
  - в настройках теперь можно указать предпочтения по переносу скобок: `tib.formatSettings`->`brace_style` одно из значений `expand` или `collapse`;
  - `CDATA` тперь располагается на одной строке с тегом и не добавляет отступ;
  - форматируются атрибуты тегов;
  - области между тегами также теперь форматируются;
  - если результат не прошёл проверку на целостность, форматирование отклоняется и выдаётся ошибка;
* тип методов, описанных в `Methods` теперь показывается в окне автозавершения;
* при разделении запятыми вставленного текста заменялась только первая табуляция;
* подсказка сигнатуры показывается теперь также при вводе `,`;
* команда комментирования в C# раньше могло давать сбои;
* раньше для новой строки после самозакрывающихся [тегов] добавлялся отсуп;
* исправлен помощник ввода: теперь показываются только правильные перегрузки;
* оптимизация и много других мелочей.

### Улучшения

* путь к демке вынесен в настройки `tib.demoPath`;
* добавлен шаблон `Methods`;
* добавлен отчёт об ошибках;
* добавлены статические методы `RegExp` и `IEnumerable`;
* включение/выключение подстановки Linq по команде `tib.useLinq` (`Ctrl` + `Alt` + `L`);
* в тему `TiburonDark` добавлена подсветка текущей строки;
* команда комментирования теперь проверяет наличие комментариев внутри выделенного текста;
* добавлены команды выделения тегов (см `Выделить тег`).


# 0.1.0 (0.1.1 fast fix) (21.02.2018)

### Исправления

* исправлено определение парных тегов, раньше в некоторых случаях работало некорректно;
* `[c#]` раньше не закрывался внутри `CustomText`;
* некоторые C# свойства и методы считались перегрузками вместе с одноимёнными свойствами/методами дочерних элементов;
* после ввода `[c#` предлагались автозавершения c#, теперь нет;
* исправлен шаблон `_expand`;
* исправления подсветки синтаксиса.

### Улучшения

* при некоторых сбоях в работе расширения всплывает окно об ошибке; **просьба сообщать обо всех возникающих ошибках**, пока не будет придуман автоматический способ сохранения логов;
* форматирование! Alfa-версия. Непробельные символы пока не затрагиваются;
* добавлены ещё функции и свойства C#;
* добавлены статические методы классов и структур из пространства имён `System`;

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/system.static.jpg?raw=true)

* добавлены всякие разные шаблоны, в том чесле для Ui (с префиксом `_`) и для C# (с префиксом `#`);
* список атрибутов для тега теперь фильтруется ещё лучше: проверяется наличие этого атрибута во всём теге;
* автозакрывание тега теперь работает только если тег ещё не закрыт (условно);
* если в CDATA оборачивается однострочный текст, то переносы не добавляются;
* стандартная команда комментирования блока теперь зависит от языка;
* комментарии теперь можно делать разноцветными (и в XML, и в C# аналогично — добавлением 1 или 2 `*`);
* после активации расширения (при открытии файла XML) появляется соответствующее сообщение в строке состояния.

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/colored_comments.jpg?raw=true)

* в `$repeat` теперь подставляется список листов;
* добавлена команда мультистрочной вставки с возможностью заменить табуляцию на запятую: `tib.paste` (`Ctrl`+`Alt`+`V`)

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/multipaste.gif?raw=true)

* команда для просмотра демки (открывается как новый файл с текстом оригинала) `tib.demo` (`Ctrl`+`Alt`+`D`);
* добавлена команда оборчивания в сворачиваемый блок: `tib.commentBlock` (`Ctrl`+`Alt`+`B`);



# 0.0.6 (18.01.2017)

### Исправления

* исправлено определение строки при незакрытом <теге> и при экранированных кавычках;
* закрытые [теги/] раньше не подсвечивались;
* значения атрибутов `SyncId` и `MixId` теперь не выделяются жёлтым, как `Id`;
* атрибуты с пустым значением раньше не подсвечивались;
* html-атрибут `style` теперь подсвечиватся правильно;
* исправлено выделение парного [тега] при наличие кодовых вставок в атрибутах;
* при множественном вводе `>` теперь закрывается каждый <тег>;
* внутри тегов с поддержкой кодовых вставок `CDATA` иногда ломала подсветку C#;

### Улучшения

* changelog в обратном порядке: сначала последние изменения;
* добавлены некоторые ранее забытые функции и свойства C#;
* автозакрытие тега `[c#]`;
* добавлены правила для отступа html тегов;

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/html-indent.gif?raw=true)

* после `Apply="` теперь тоже выпадает список страниц;
* добавлены атрибуты для Quota.Item: `Page`, `Question`, `Answer`;
* добавлен список значений атрибута `Operator` для `Item` (`MoreEquals`, `Less` и т.д.);
* в список всех страниц скрипта добавлена `pre_data`;
* большинство атрибутов (которые не строковые) теперь подставляются со значением по умолчанию;
* добавлены новые удобные snippet'ы (можно найти по префиксу `_`), а также `<Filter>return ;</Filter>`;
* добавлена подсветка кодовых вставок в атрибутах html;
* в настройки расширения добавлен параметр `tib.ignoreComments` - пропускать комментарии при сборе данных о страницах и методах скрипта (не предлагаются в автозавершении);
* добавлена операция оборачивания выделенного текста в `CDATA`: `tib.cdata` (назначено сочетание клавиш `Ctrl`+`Alt`+`C`);
* доработана подсветка строчных методов и строчных repeat;

* много других (малозаметных, но важных) технических исправлений и улучшений;

### Дополнительно

* В силу технических особенностей VSCode для подстановки списка страниц в источник `<Repeat` этот snippet был удалён. Теперь `<Repeat` ведёт себя как обычный тег.

![Image](https://github.com/tiburon-research/vsc-xml-plugin/blob/master/stuff/new-repeat.gif?raw=true)

* Изменены некоторые цвета темы.

# 0.0.5 (20.12.2017)

### Исправления

* закрывание <тегов> при принятии автозавершения;
* подсказки, автозавершения и переходы к определению раньше иногда могли подтягиваться из других открытых файлов;
* [теги] внутри `CustomText` теперь не закрываются;
* после точки предлагаются только дочерние методы/свойства этого объекта;

### Улучшения

* добавлена тема `Tiburon Dark`
* скобки после принятия автозавершения функции/метода подставляются только если их там ещё нет;
* после `Page=` подставляются все Id страниц из файла;
* после принятия автозавершения для значения атрибута кавычка закрывается автоматически;
* snippets для c# (такие, как foreach, while и т.д.);
* вставка `sexList` (подробнее см. в описании);
* добавлена команда преобразования `Answer` <-> `Item` (подробнее см. в описании);
* все теги теперь подсвечиваются попарно.

* другие технические исправления и улучшения;


# 0.0.3 (0.0.4 fast fix) (11.12.2017)

### Исправления

* много исправлений подсветки синтаксиса;
* корректное имя закрывающегося [тега];
* внутри C# теперь [теги] закрываются автоматически только внутри строк;
* `перейти к определению` раньше работало не всегда корректно, теперь должно нормально;
* раньше иногда <теги> переставали закрываться, сейчас, вроде ок;

### Улучшения

* Id листов подставляются после `<Repeat List="` и в `CurrentSurvey.Lists["`;
* предложения об автозавершении теперь зависят от того, находится ли курсор внутри строкового элемента;
* закрывающаяся угловая скобка теперь автоматически не закрывается после ввода слеша, т.к. эта функция только мешала;
* добавлены элементы автозавершения;
* перейти к Page/List/Quota теперь можно из любого (теоретически) места в документе;
* обернуть выделенный текст в тег теперь можно, нажав `ctrl`+`Alt`+`T` (подробнее см. в описании);
* функции и переменные, описанные (с модификатором дуступа) в `<Methods>` теперь появляются в списке автозавершения и их сигнатуры видны при наведении.
* после `$` подставляется только список пользовательских методов.


# 0.0.2 (29.10.2017)

### Исправления

* перечисления (например, `LogicalOperator.Or`) показываются в автозавершениях;
* корректные предложения для автозавершения `<Item` внутри Redirect/Validate/Quota;
* исправлено положение подставляемого закрывающего тега;
* одиночные теги типа `[br]` теперь автоматически не закрываются;
* исправлены проблемы подсветки для закрытых тегов `<Redirect/>`.

### Улучшения

* добавлен атрибут `Operator` в `<Item` для Redirect/Validate/Quota;


# 0.0.1 (27.10.2017)

### Улучшения

* возможность посмотреть/перейти к определению C#-метода;


# 0.0.0 (24.10.2017)

Альфа-тестирование